[ lab week 3

SELECT d.name, e.name
FROM department d, employee e 
WHERE (d.director = e.number) AND EXIST (SELECT * FROM employee e2
                                          WHERE e2.supervisor = e.number)




 SELECT e2.name
 FROM employee e1, employee e2, department d  
 WHERE e2.number = e1.supervisor OR d.director = e1.number



SELECT e1.name
FROM employee e1
WHERE e1.number NOT IN (SELECT e.supervisor
                        FROM employee e2, employee e
                        WHERE e2.number = e.supervisor)

]




SELECT e.name, p.income
FROM employee e, position p 
WHERE e.position = p.code AND income BETWEEN 200 AND 600


SELECT d.name, COUNT(e.department)
FROM department d, employee e 
WHERE d.code = e.department
GROUP BY d.name 



SELECT super.name, COUNT(e1.number)
FROM  employee super, employee e1
WHERE super.number = e1.supervisor
GROUP BY e1.supervisor
HAVING COUNT(e1.number) >= 2   




SELECT super.name, COUNT(e1.number)
FROM employee super, employee e1, department d
WHERE d.code = e1.department AND super.number = e1.supervisor 
AND e1.department NOT IN (SELECT d.location
                          FROM department d, 
                          WHERE d.location = 'Hanoi'
                         )
GROUP BY e.supervisor
//
SELECT super.name, COUNT(e1.number)
FROM employee super, employee e1, department d
WHERE d.code = e1.department AND super.number = e1.supervisor 
AND d.location <> 'Hanoi
GROUP BY super.name



SELECT e.position, d.name, COUNT(e.name)
FROM employee e, department d
WHERE e.department = d.code 
GROUP BY d.code, e.position



SELECT e.position, p.income, COUNT(e.number)
FROM employee e, position p
WHERE e.position = p.code AND d.code = e.department AND d.location <> 'Hanoi'
GROUP BY e.position
